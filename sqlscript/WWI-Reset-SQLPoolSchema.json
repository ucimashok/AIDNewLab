{
	"name": "WWI-Reset-SQLPoolSchema",
	"properties": {
		"content": {
			"query": "create schema wwi\r\ngo\r\ncreate schema wwi_perf\r\ngo\r\ncreate schema wwi_staging\r\ngo\r\ncreate schema wwi_ml\r\ngo\r\n\r\nIF OBJECT_ID('wwi.DimCity', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimCity\r\nGO\r\n\r\n--Location was eliminated (data type geography not supported)\r\n\r\nCREATE TABLE [wwi].[DimCity]\r\n(\r\n    [CityKey] [int] NOT NULL,\r\n\t[WWICityID] [int] NOT NULL,\r\n\t[City] [nvarchar](50) NOT NULL,\r\n\t[StateProvince] [nvarchar](50) NOT NULL,\r\n\t[Country] [nvarchar](60) NOT NULL,\r\n\t[Continent] [nvarchar](30) NOT NULL,\r\n\t[SalesTerritory] [nvarchar](50) NOT NULL,\r\n\t[Region] [nvarchar](30) NOT NULL,\r\n\t[Subregion] [nvarchar](30) NOT NULL,\r\n\t[LatestRecordedPopulation] [bigint] NOT NULL,\r\n\t[ValidFrom] [datetime2](7) NOT NULL,\r\n\t[ValidTo] [datetime2](7) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.DimCustomer', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimCustomer\r\nGO\r\n\r\nCREATE TABLE [wwi].[DimCustomer](\r\n\t[CustomerKey] [int] NOT NULL,\r\n\t[WWICustomerID] [int] NOT NULL,\r\n\t[Customer] [nvarchar](100) NOT NULL,\r\n\t[BillToCustomer] [nvarchar](100) NOT NULL,\r\n\t[Category] [nvarchar](50) NOT NULL,\r\n\t[BuyingGroup] [nvarchar](50) NOT NULL,\r\n\t[PrimaryContact] [nvarchar](50) NOT NULL,\r\n\t[PostalCode] [nvarchar](10) NOT NULL,\r\n\t[ValidFrom] [datetime2](7) NOT NULL,\r\n\t[ValidTo] [datetime2](7) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.DimDate', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimDate\r\nGO\r\n\r\nCREATE TABLE [wwi].[DimDate](\r\n\t[Date] [date] NOT NULL,\r\n\t[DayNumber] [int] NOT NULL,\r\n\t[Day] [nvarchar](10) NOT NULL,\r\n\t[Month] [nvarchar](10) NOT NULL,\r\n\t[ShortMonth] [nvarchar](3) NOT NULL,\r\n\t[CalendarMonthNumber] [int] NOT NULL,\r\n\t[CalendarMonthLabel] [nvarchar](20) NOT NULL,\r\n\t[CalendarYear] [int] NOT NULL,\r\n\t[CalendarYearLabel] [nvarchar](10) NOT NULL,\r\n\t[FiscalMonthNumber] [int] NOT NULL,\r\n\t[FiscalMonthLabel] [nvarchar](20) NOT NULL,\r\n\t[FiscalYear] [int] NOT NULL,\r\n\t[FiscalYearLabel] [nvarchar](10) NOT NULL,\r\n\t[ISOWeekNumber] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.DimEmployee', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimEmployee\r\nGO\r\n\r\n-- Photo was eliminated (data type varbinary cannot participate in a columnstore index)\r\n\r\nCREATE TABLE [wwi].[DimEmployee](\r\n\t[EmployeeKey] [int] NOT NULL,\r\n\t[WWIEmployeeID] [int] NOT NULL,\r\n\t[Employee] [nvarchar](50) NOT NULL,\r\n\t[PreferredName] [nvarchar](50) NOT NULL,\r\n\t[IsSalesperson] [bit] NOT NULL,\r\n\t[ValidFrom] [datetime2](7) NOT NULL,\r\n\t[ValidTo] [datetime2](7) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.DimPaymentMethod', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimPaymentMethod\r\nGO\r\n\r\nCREATE TABLE [wwi].[DimPaymentMethod](\r\n\t[PaymentMethodKey] [int] NOT NULL,\r\n\t[WWIPaymentMethodID] [int] NOT NULL,\r\n\t[PaymentMethod] [nvarchar](50) NOT NULL,\r\n\t[ValidFrom] [datetime2](7) NOT NULL,\r\n\t[ValidTo] [datetime2](7) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.DimStockItem', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimStockItem\r\nGO\r\n\r\n-- Photo was eliminated (data type varbinary cannot participate in a columnstore index)\r\n\r\nCREATE TABLE [wwi].[DimStockItem](\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[WWIStockItemID] [int] NOT NULL,\r\n\t[Stock Item] [nvarchar](100) NOT NULL,\r\n\t[Color] [nvarchar](20) NOT NULL,\r\n\t[SellingPackage] [nvarchar](50) NOT NULL,\r\n\t[Buying Package] [nvarchar](50) NOT NULL,\r\n\t[Brand] [nvarchar](50) NOT NULL,\r\n\t[Size] [nvarchar](20) NOT NULL,\r\n\t[LeadTimeDays] [int] NOT NULL,\r\n\t[QuantityPerOuter] [int] NOT NULL,\r\n\t[IsChillerStock] [bit] NOT NULL,\r\n\t[Barcode] [nvarchar](50) NULL,\r\n\t[TaxRate] [decimal](18, 3) NOT NULL,\r\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\r\n\t[RecommendedRetailPrice] [decimal](18, 2) NULL,\r\n\t[TypicalWeightPerUnit] [decimal](18, 3) NOT NULL,\r\n\t[ValidFrom] [datetime2](7) NOT NULL,\r\n\t[ValidTo] [datetime2](7) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.DimSupplier', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimSupplier\r\nGO\r\n\r\n\r\nCREATE TABLE [wwi].[DimSupplier](\r\n\t[SupplierKey] [int] NOT NULL,\r\n\t[WWISupplierID] [int] NOT NULL,\r\n\t[Supplier] [nvarchar](100) NOT NULL,\r\n\t[Category] [nvarchar](50) NOT NULL,\r\n\t[PrimaryContact] [nvarchar](50) NOT NULL,\r\n\t[SupplierReference] [nvarchar](20) NULL,\r\n\t[PaymentDays] [int] NOT NULL,\r\n\t[PostalCode] [nvarchar](10) NOT NULL,\r\n\t[ValidFrom] [datetime2](7) NOT NULL,\r\n\t[ValidTo] [datetime2](7) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.DimTransactionType', 'U') IS NOT NULL\r\n    DROP TABLE wwi.DimTransactionType\r\nGO\r\n\r\nCREATE TABLE [wwi].[DimTransactionType](\r\n\t[TransactionTypeKey] [int] NOT NULL,\r\n\t[WWITransactionTypeID] [int] NOT NULL,\r\n\t[TransactionType] [nvarchar](50) NOT NULL,\r\n\t[ValidFrom] [datetime2](7) NOT NULL,\r\n\t[ValidTo] [datetime2](7) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = REPLICATE\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.FactMovement', 'U') IS NOT NULL\r\n    DROP TABLE wwi.FactMovement\r\nGO\r\n\r\nCREATE TABLE [wwi].[FactMovement](\r\n\t[MovementKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[DateKey] [date] NOT NULL,\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[CustomerKey] [int] NULL,\r\n\t[SupplierKey] [int] NULL,\r\n\t[TransactionTypeKey] [int] NOT NULL,\r\n\t[WWIStockItemTransactionID] [int] NOT NULL,\r\n\t[WWIInvoiceID] [int] NULL,\r\n\t[WWIPurchaseOrderID] [int] NULL,\r\n\t[Quantity] [int] NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = HASH ([CustomerKey]),\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.FactOrder', 'U') IS NOT NULL\r\n    DROP TABLE wwi.FactOrder\r\nGO\r\n\r\nCREATE TABLE [wwi].[FactOrder](\r\n\t[OrderKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[CityKey] [int] NOT NULL,\r\n\t[CustomerKey] [int] NOT NULL,\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[OrderDateKey] [date] NOT NULL,\r\n\t[PickedDateKey] [date] NULL,\r\n\t[SalespersonKey] [int] NOT NULL,\r\n\t[PickerKey] [int] NULL,\r\n\t[WWIOrderID] [int] NOT NULL,\r\n\t[WWIBackorderID] [int] NULL,\r\n\t[Description] [nvarchar](100) NOT NULL,\r\n\t[Package] [nvarchar](50) NOT NULL,\r\n\t[Quantity] [int] NOT NULL,\r\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\r\n\t[TaxRate] [decimal](18, 3) NOT NULL,\r\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\r\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = HASH ([CustomerKey]),\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.FactPurchase', 'U') IS NOT NULL\r\n    DROP TABLE wwi.FactPurchase\r\nGO\r\n\r\nCREATE TABLE [wwi].[FactPurchase](\r\n\t[PurchaseKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[DateKey] [date] NOT NULL,\r\n\t[SupplierKey] [int] NOT NULL,\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[WWIPurchaseOrderID] [int] NULL,\r\n\t[OrderedOuters] [int] NOT NULL,\r\n\t[OrderedQuantity] [int] NOT NULL,\r\n\t[ReceivedOuters] [int] NOT NULL,\r\n\t[Package] [nvarchar](50) NOT NULL,\r\n\t[IsOrderFinalized] [bit] NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = HASH ([SupplierKey]),\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.FactSale', 'U') IS NOT NULL\r\n    DROP TABLE wwi.FactSale\r\nGO\r\n\r\nCREATE TABLE [wwi].[FactSale](\r\n\t[SaleKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[CityKey] [int] NOT NULL,\r\n\t[CustomerKey] [int] NOT NULL,\r\n\t[BillToCustomerKey] [int] NOT NULL,\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[InvoiceDateKey] [date] NOT NULL,\r\n\t[DeliveryDateKey] [date] NULL,\r\n\t[SalespersonKey] [int] NOT NULL,\r\n\t[WWIInvoiceID] [int] NOT NULL,\r\n\t[Description] [nvarchar](100) NOT NULL,\r\n\t[Package] [nvarchar](50) NOT NULL,\r\n\t[Quantity] [int] NOT NULL,\r\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\r\n\t[TaxRate] [decimal](18, 3) NOT NULL,\r\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\r\n\t[Profit] [decimal](18, 2) NOT NULL,\r\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TotalDryItems] [int] NOT NULL,\r\n\t[TotalChillerItems] [int] NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = HASH ([CustomerKey]),\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi_perf.FactSale_Slow', 'U') IS NOT NULL\r\n    DROP TABLE wwi_perf.FactSale\r\nGO\r\n\r\nCREATE TABLE [wwi_perf].[FactSale_Slow](\r\n\t[SaleKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[CityKey] [int] NOT NULL,\r\n\t[CustomerKey] [int] NOT NULL,\r\n\t[BillToCustomerKey] [int] NOT NULL,\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[InvoiceDateKey] [date] NOT NULL,\r\n\t[DeliveryDateKey] [date] NULL,\r\n\t[SalespersonKey] [int] NOT NULL,\r\n\t[WWIInvoiceID] [int] NOT NULL,\r\n\t[Description] [nvarchar](100) NOT NULL,\r\n\t[Package] [nvarchar](50) NOT NULL,\r\n\t[Quantity] [int] NOT NULL,\r\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\r\n\t[TaxRate] [decimal](18, 3) NOT NULL,\r\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\r\n\t[Profit] [decimal](18, 2) NOT NULL,\r\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TotalDryItems] [int] NOT NULL,\r\n\t[TotalChillerItems] [int] NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = ROUND_ROBIN,\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi_perf.FactSale_Fast', 'U') IS NOT NULL\r\n    DROP TABLE wwi_perf.FactSale_Fast\r\nGO\r\n\r\nCREATE TABLE [wwi_perf].[FactSale_Fast](\r\n\t[SaleKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[CityKey] [int] NOT NULL,\r\n\t[CustomerKey] [int] NOT NULL,\r\n\t[BillToCustomerKey] [int] NOT NULL,\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[InvoiceDateKey] [date] NOT NULL,\r\n\t[DeliveryDateKey] [date] NULL,\r\n\t[SalespersonKey] [int] NOT NULL,\r\n\t[WWIInvoiceID] [int] NOT NULL,\r\n\t[Description] [nvarchar](100) NOT NULL,\r\n\t[Package] [nvarchar](50) NOT NULL,\r\n\t[Quantity] [int] NOT NULL,\r\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\r\n\t[TaxRate] [decimal](18, 3) NOT NULL,\r\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\r\n\t[Profit] [decimal](18, 2) NOT NULL,\r\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TotalDryItems] [int] NOT NULL,\r\n\t[TotalChillerItems] [int] NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = HASH ([CustomerKey]),\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.FactStockHolding', 'U') IS NOT NULL\r\n    DROP TABLE wwi.FactStockHolding\r\nGO\r\n\r\nCREATE TABLE [wwi].[FactStockHolding](\r\n\t[StockHoldingKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[StockItemKey] [int] NOT NULL,\r\n\t[QuantityOnHand] [int] NOT NULL,\r\n\t[BinLocation] [nvarchar](20) NOT NULL,\r\n\t[LastStocktakeQuantity] [int] NOT NULL,\r\n\t[LastCostPrice] [decimal](18, 2) NOT NULL,\r\n\t[ReorderLevel] [int] NOT NULL,\r\n\t[TargetStockLevel] [int] NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = HASH ([StockItemKey]),\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\nIF OBJECT_ID('wwi.FactTransaction', 'U') IS NOT NULL\r\n    DROP TABLE wwi.FactTransaction\r\nGO\r\n\r\nCREATE TABLE [wwi].[FactTransaction](\r\n\t[TransactionKey] [bigint] IDENTITY(1,1) NOT NULL,\r\n\t[DateKey] [date] NOT NULL,\r\n\t[CustomerKey] [int] NULL,\r\n\t[BillToCustomerKey] [int] NULL,\r\n\t[SupplierKey] [int] NULL,\r\n\t[TransactionTypeKey] [int] NOT NULL,\r\n\t[PaymentMethodKey] [int] NULL,\r\n\t[WWICustomerTransaction ID] [int] NULL,\r\n\t[WWISupplierTransaction ID] [int] NULL,\r\n\t[WWIInvoiceID] [int] NULL,\r\n\t[WWIPurchaseOrderID] [int] NULL,\r\n\t[SupplierInvoiceNumber] [nvarchar](20) NULL,\r\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\r\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\r\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\r\n\t[OutstandingBalance] [decimal](18, 2) NOT NULL,\r\n\t[IsFinalized] [bit] NOT NULL,\r\n\t[LineageKey] [int] NOT NULL\r\n)\r\nWITH\r\n(\r\n    DISTRIBUTION = HASH ([CustomerKey]),\r\n    CLUSTERED COLUMNSTORE INDEX\r\n)\r\nGO\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "SQLPool01",
				"type": "SqlPool"
			}
		},
		"type": "SqlQuery"
	}
}